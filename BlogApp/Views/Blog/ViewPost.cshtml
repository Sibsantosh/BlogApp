@{
    var post = (Posts)ViewBag.post;
    var comment = (CommentResponseModel)ViewBag.comments;
    string link = $"https://picsum.photos/id/{post.Post_id}/1000/400";
}

<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        /* Your custom CSS styles can go here */
        
        .container {
            display: grid;
            height:auto;
            gap: 20px;
            margin-bottom: 200px;
           
        }

        .card {
            background-color: #f8f9fa;
            border: 1px solid #ced4da;
            border-radius: 5px;
            padding: 20px;
            width:1200px;
            height:auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
             /* Added to allow absolute positioning inside the card */
        }

        .card-top {
            position: relative;
        }

        .admin-options {
            position: absolute;
            top: 10px; /* Adjust as needed */
            right: 10px; /* Adjust as needed */
            display: flex;
        }

        .edit-img-top,
        .delete-img-top {
            width: 25px;
            height: 25px;
            margin-left: 5px; /* Adjust spacing between icons */
        }

        .card-title {
            font-size: 28px;
        }

        .card-text {
            font-size: 15px;
        }

        .comment {
            margin-bottom: 20px;
        }

        .comment-body {
            margin-top: 10px;
        }

        .comment-footer {
            font-size: 12px;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="container">

    
    <div class="card" >
        <div class="card-top">
                
            <img class="card-img-top" src=@link alt="Card image cap">
            <div class="admin-options">
                @if (Program.isAdmin || Program.authenticatedUser != null && post.Author_id == Program.authenticatedUser.User_id)
                {
                    <a asp-action="EditPost" asp-route-id="@post.Post_id">
                        <img class="edit-img-top" src="~/images/edit.png" alt="Card edit">
                    </a>
                    <a asp-action="DeletePost" asp-route-id="@post.Post_id">
                        <img class="delete-img-top" src="~/images/delete.png" asp-aciton="DeletePost" id="@post.Post_id" alt="Card delete">
                    </a>
                }
            </div>
        </div>
        <div class="card-body">
            <h5 class="card-title">@post.Title</h5>
            <p class="card-text">@post.Content.</p>
            @* <a href="#" class="btn btn-primary">Go somewhere</a> *@
        </div>
    </div>

    
    @if (Program.authenticatedUser != null)
        {
            int count = 1;

                <form id="commentForm" action="StoreComment">
                    <div class="form-group">
                        <label for="comment">Add a comment:</label>
                        <input type="hidden" id="post_id" name="post_id" value="@post.Post_id"/>
                        <input type="hidden" id="user_id" name ="user_id" value="@post.Author_id"/>
                        <textarea class="form-control" name="content" id="content" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>

                <!-- Comments List -->
            @foreach (var item in comment.commentList)
            {
                count++;
                string timeZoneId = "Eastern Standard Time"; // Example timezone ID

                // Convert milliseconds to DateTime in the specified timezone
                DateTimeOffset dateTimeOffset = DateTimeOffset.FromUnixTimeMilliseconds(item.comment_epoch);
                DateTime dateTime = TimeZoneInfo.ConvertTime(dateTimeOffset.DateTime, TimeZoneInfo.FindSystemTimeZoneById(timeZoneId));
                var link1 = $"https://i.pravatar.cc/40?img={(count - 1)}";
                <div class="card">
                    <div class="admin-options">
                        @if (Program.isAdmin || Program.authenticatedUser != null && post.Author_id == Program.authenticatedUser.User_id || item.user_id == Program.authenticatedUser.User_id)
                        {
                            <a asp-action="" asp-route-id="@post.Post_id">
                                <img class="edit-img-top" src="~/images/edit.png" alt="Card edit">
                            </a>
                            <a asp-action="DeleteComment" asp-route-id="@item.comment_id">
                                <img class="delete-img-top" src="~/images/delete.png" asp-aciton="DeletePost" id="@post.Post_id" alt="Card delete">
                            </a>
                        }
                    </div>
                    <!-- Example comment -->
                    <div class="comment">
                        <span>
                        <img src=@link class="comment-img" /></span>
                        <span> @item.user_name </span> 
                        <div class="comment-body">
                            
                            @item.content.
                        </div>
                        <div class="comment-footer">
                             <span>Posted at: @dateTime</span>
                        </div>
                    </div>
                    <!-- Add more comments dynamically here -->
                </div>
            }
        }
    </div>
    <!-- Bootstrap and other JavaScript libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Your custom JavaScript code can go here -->
</body>
</html>
